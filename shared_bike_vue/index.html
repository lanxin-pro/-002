<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
        <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
        <link rel="stylesheet" href="css/admin.css">
</head>
<body>
	<div id="app">
		<el-container class="home_container">
                        <el-header>
                            <el-avatar :src="faceImg"></el-avatar>
                            <span class="home_title">共享单车管理系统</span>
                            <el-button class="menu-toggle" icon="el-icon-s-operation" circle plain @click="toggleCollapse"></el-button>
                            <div class="home_userinfoContainer">
                                <el-avatar :src="userImg"></el-avatar>
                                <el-dropdown>
                                  <span class="el-dropdown-link home_userinfo">
                                    {{user.username}}<i class="el-icon-arrow-down el-icon--right home_userinfo"></i>
                                  </span>
                                  <el-dropdown-menu slot="dropdown">
                                    <el-dropdown-item @click.native="logout">退出登录</el-dropdown-item>
                                  </el-dropdown-menu>
                                </el-dropdown>
                            </div>
                        </el-header>
		        <el-container>
                                        <el-aside :width="isCollapse ? '64px' : '200px'">
                                <el-menu :collapse="isCollapse" background-color="#545c64" text-color="#fff" active-text-color="#ffd04b">
                                                        <el-menu-item v-for="item in menu" :index="item.icon+''">
                                                            <a @click="dispatcher(item.href,item.title)" class="menu-link">
                                                                        <span class="menu-text"><i :class="item.icon"></i>{{item.title}}</span>
                                                            </a>
                                                        </el-menu-item>
                                </el-menu>
		            </el-aside>
		            <el-container>
                                <el-main>
                                    <el-breadcrumb separator-class="el-icon-arrow-right" class="main-breadcrumb">
                                        <el-breadcrumb-item>{{title}}</el-breadcrumb-item>
                                    </el-breadcrumb>
                                    <iframe :src="iframeSrc" class="main-iframe"></iframe>
                                </el-main>
                                <el-footer>@2024 Shared Bike System</el-footer>
                            </el-container>
		
		        </el-container>
		
		    </el-container>
	</div>
</body>
<script src="js/vue.js"></script>
<script src="js/elementui.js"></script>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  new Vue({
	el: '#app',
        methods: {
                logout(){
			let _this = this;
			this.$confirm('注销登录吗?', '提示', {
				confirmButtonText: '确定',
				cancelButtonText: '取消',
				type: 'warning'
			}).then(function () {
				localStorage.removeItem('user')
				location.href='login.html'
			})
		},
                dispatcher(src,title){
                        this.iframeSrc = src
                        this.title = title
                }
                ,toggleCollapse(){
                        this.isCollapse = !this.isCollapse
                }
        },
	mounted: function () {
		let user = JSON.parse(window.localStorage.getItem('user'))
		this.user = user
		let _this = this
		axios.get('http://localhost:8181/menu/leftMenu').then(function (response) {
		  _this.menu = response.data
		})
	},
	data(){
		return {
			user:'',
			faceImg:'images/face.jpg',
			userImg:'images/user.jpg',
                        menu:'',
                        iframeSrc:'welcome.html',
                        title:'首页',
                        isCollapse:false
                }
        }
  })
</script>
	
<style>
    /* additional page specific styles can be placed here */
</style>
</html>
